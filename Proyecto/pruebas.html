<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Prueba Carrito</title>
</head>
<body>

  <div class="tarjeta" id="spiderman2" data-id="spiderman2">
    <img width="250" height="300" src="images/spider.jpg" alt="spider" />
    <div class="contenido">
      <div class="titulo">Marvel´s Spider-man 2</div>
      <div class="descripcion">PS5</div>
      <div class="precio">
        <del>$69.990</del>
        <span class="precio-descuento">$39.990</span>
      </div>
      <button onclick="addToCart('Marvel´s Spider-man 2', 39990, 'images/spider.jpg', 'spiderman2')">Añadir al carrito</button>
    </div>
  </div>

  <hr />

  <div class="carrito-contenedor">
    <div class="carrito-productos">
      <table border="1" cellpadding="5">
        <thead>
          <tr>
            <th>Detalle de producto</th>
            <th>Cantidad</th>
            <th>Subtotal</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="carrito-body"></tbody>
      </table>
      <button onclick="vaciarCarrito()">VACIAR EL CARRITO</button>
    </div>

    <div class="carrito-resumen">
      <h3>Resumen</h3>
      <p>Subtotal: <span id="resumen-subtotal">$0</span></p>
      <p>Envío: <span>$0</span></p>
      <hr />
      <p><strong>Total compra:</strong> <span id="resumen-total">$0</span></p>
      <button>COMPRAR</button>
    </div>
  </div>

<script>
  let carrito = [];

  function addToCart(nombre, precio, imagen, id) {
    const productoExistente = carrito.find(p => p.id === id);

    if (productoExistente) {
      productoExistente.cantidad++;
      productoExistente.subtotal = productoExistente.precio * productoExistente.cantidad;
    } else {
      carrito.push({
        id,
        nombre,
        imagen,
        precio,
        cantidad: 1,
        subtotal: precio
      });
    }

    actualizarCarrito();
  }

  function actualizarCarrito() {
    const tbody = document.getElementById('carrito-body');
    tbody.innerHTML = '';

    let total = 0;

    carrito.forEach(producto => {
      const fila = document.createElement('tr');
      fila.innerHTML = `
        <td><img src="${producto.imagen}" width="40" style="vertical-align:middle; margin-right:10px;">${producto.nombre}</td>
        <td>${producto.cantidad}</td>
        <td>$${producto.subtotal.toLocaleString()}</td>
        <td><button onclick="eliminarDelCarrito('${producto.id}')">❌</button></td>
      `;
      tbody.appendChild(fila);
      total += producto.subtotal;
    });

    document.getElementById('resumen-subtotal').innerText = `$${total.toLocaleString()}`;
    document.getElementById('resumen-total').innerText = `$${total.toLocaleString()}`;
  }

  function eliminarDelCarrito(id) {
    carrito = carrito.filter(p => p.id !== id);
    actualizarCarrito();
  }

  function vaciarCarrito() {
    carrito = [];
    actualizarCarrito();
  }
</script>

</body>
</html>
